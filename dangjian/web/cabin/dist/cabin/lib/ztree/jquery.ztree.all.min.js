!function(q){var H,I,J,K,L,M,u,r={},v={},w={},N={treeId:"",treeObj:null,view:{addDiyDom:null,autoCancelSelected:!0,dblClickExpand:!0,expandSpeed:"fast",fontCss:{},nameIsHTML:!1,selectedMulti:!0,showIcon:!0,showLine:!0,showTitle:!0,txtSelectedEnable:!1},data:{key:{children:"children",name:"name",title:"",url:"url",icon:"icon"},simpleData:{enable:!1,idKey:"id",pIdKey:"pId",rootPId:null},keep:{parent:!1,leaf:!1}},async:{enable:!1,contentType:"application/x-www-form-urlencoded",type:"post",dataType:"text",url:"",autoParam:[],otherParam:[],dataFilter:null},callback:{beforeAsync:null,beforeClick:null,beforeDblClick:null,beforeRightClick:null,beforeMouseDown:null,beforeMouseUp:null,beforeExpand:null,beforeCollapse:null,beforeRemove:null,onAsyncError:null,onAsyncSuccess:null,onNodeCreated:null,onClick:null,onDblClick:null,onRightClick:null,onMouseDown:null,onMouseUp:null,onExpand:null,onCollapse:null,onRemove:null}},x=[function(a){var b=a.treeObj,c=f.event;b.bind(c.NODECREATED,function(b,c,d){j.apply(a.callback.onNodeCreated,[b,c,d])}),b.bind(c.CLICK,function(b,c,d,e,f){j.apply(a.callback.onClick,[c,d,e,f])}),b.bind(c.EXPAND,function(b,c,d){j.apply(a.callback.onExpand,[b,c,d])}),b.bind(c.COLLAPSE,function(b,c,d){j.apply(a.callback.onCollapse,[b,c,d])}),b.bind(c.ASYNC_SUCCESS,function(b,c,d,e){j.apply(a.callback.onAsyncSuccess,[b,c,d,e])}),b.bind(c.ASYNC_ERROR,function(b,c,d,e,f,g){j.apply(a.callback.onAsyncError,[b,c,d,e,f,g])}),b.bind(c.REMOVE,function(b,c,d){j.apply(a.callback.onRemove,[b,c,d])}),b.bind(c.SELECTED,function(b,c,d){j.apply(a.callback.onSelected,[c,d])}),b.bind(c.UNSELECTED,function(b,c,d){j.apply(a.callback.onUnSelected,[c,d])})}],y=[function(a){var b=f.event;a.treeObj.unbind(b.NODECREATED).unbind(b.CLICK).unbind(b.EXPAND).unbind(b.COLLAPSE).unbind(b.ASYNC_SUCCESS).unbind(b.ASYNC_ERROR).unbind(b.REMOVE).unbind(b.SELECTED).unbind(b.UNSELECTED)}],z=[function(a){var b=h.getCache(a);b||(b={},h.setCache(a,b)),b.nodes=[],b.doms=[]}],A=[function(a,b,c,d,e,f){if(c){var g=h.getRoot(a),i=a.data.key.children;c.level=b,c.tId=a.treeId+"_"+ ++g.zId,c.parentTId=d?d.tId:null,c.open="string"==typeof c.open?j.eqs(c.open,"true"):!!c.open,c[i]&&c[i].length>0?(c.isParent=!0,c.zAsync=!0):(c.isParent="string"==typeof c.isParent?j.eqs(c.isParent,"true"):!!c.isParent,c.open=!(!c.isParent||a.async.enable)&&c.open,c.zAsync=!c.isParent),c.isFirstNode=e,c.isLastNode=f,c.getParentNode=function(){return h.getNodeCache(a,c.parentTId)},c.getPreNode=function(){return h.getPreNode(a,c)},c.getNextNode=function(){return h.getNextNode(a,c)},c.getIndex=function(){return h.getNodeIndex(a,c)},c.getPath=function(){return h.getNodePath(a,c)},c.isAjaxing=!1,h.fixPIdKeyValue(a,c)}}],t=[function(a){var b=a.target,c=h.getSetting(a.data.treeId),d="",e=null,g="",i="",k=null,l=null,m=null;if(j.eqs(a.type,"mousedown")?i="mousedown":j.eqs(a.type,"mouseup")?i="mouseup":j.eqs(a.type,"contextmenu")?i="contextmenu":j.eqs(a.type,"click")?j.eqs(b.tagName,"span")&&null!==b.getAttribute("treeNode"+f.id.SWITCH)?(d=j.getNodeMainDom(b).id,g="switchNode"):(m=j.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(d=j.getNodeMainDom(m).id,g="clickNode"):j.eqs(a.type,"dblclick")&&(i="dblclick",m=j.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(d=j.getNodeMainDom(m).id,g="switchNode"),i.length>0&&0==d.length&&(m=j.getMDom(c,b,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(d=j.getNodeMainDom(m).id),d.length>0)switch(e=h.getNodeCache(c,d),g){case"switchNode":e.isParent&&(j.eqs(a.type,"click")||j.eqs(a.type,"dblclick")&&j.apply(c.view.dblClickExpand,[c.treeId,e],c.view.dblClickExpand))?k=H:g="";break;case"clickNode":k=I}switch(i){case"mousedown":l=J;break;case"mouseup":l=K;break;case"dblclick":l=L;break;case"contextmenu":l=M}return{stop:!1,node:e,nodeEventType:g,nodeEventCallback:k,treeEventType:i,treeEventCallback:l}}],B=[function(a){var b=h.getRoot(a);b||(b={},h.setRoot(a,b)),b[a.data.key.children]=[],b.expandTriggerFlag=!1,b.curSelectedList=[],b.noSelection=!0,b.createdNodes=[],b.zId=0,b._ver=(new Date).getTime()}],C=[],D=[],E=[],F=[],G=[],h={addNodeCache:function(a,b){h.getCache(a).nodes[h.getNodeCacheId(b.tId)]=b},getNodeCacheId:function(a){return a.substring(a.lastIndexOf("_")+1)},addAfterA:function(a){D.push(a)},addBeforeA:function(a){C.push(a)},addInnerAfterA:function(a){F.push(a)},addInnerBeforeA:function(a){E.push(a)},addInitBind:function(a){x.push(a)},addInitUnBind:function(a){y.push(a)},addInitCache:function(a){z.push(a)},addInitNode:function(a){A.push(a)},addInitProxy:function(a,b){b?t.splice(0,0,a):t.push(a)},addInitRoot:function(a){B.push(a)},addNodesData:function(a,b,c,d){var e=a.data.key.children;b[e]?c>=b[e].length&&(c=-1):(b[e]=[],c=-1),b[e].length>0&&0===c?(b[e][0].isFirstNode=!1,i.setNodeLineIcos(a,b[e][0])):b[e].length>0&&c<0&&(b[e][b[e].length-1].isLastNode=!1,i.setNodeLineIcos(a,b[e][b[e].length-1])),b.isParent=!0,c<0?b[e]=b[e].concat(d):(a=[c,0].concat(d),b[e].splice.apply(b[e],a))},addSelectedNode:function(a,b){var c=h.getRoot(a);h.isSelectedNode(a,b)||c.curSelectedList.push(b)},addCreatedNode:function(a,b){(a.callback.onNodeCreated||a.view.addDiyDom)&&h.getRoot(a).createdNodes.push(b)},addZTreeTools:function(a){G.push(a)},exSetting:function(a){q.extend(!0,N,a)},fixPIdKeyValue:function(a,b){a.data.simpleData.enable&&(b[a.data.simpleData.pIdKey]=b.parentTId?b.getParentNode()[a.data.simpleData.idKey]:a.data.simpleData.rootPId)},getAfterA:function(a,b,c){for(var d=0,e=D.length;d<e;d++)D[d].apply(this,arguments)},getBeforeA:function(a,b,c){for(var d=0,e=C.length;d<e;d++)C[d].apply(this,arguments)},getInnerAfterA:function(a,b,c){for(var d=0,e=F.length;d<e;d++)F[d].apply(this,arguments)},getInnerBeforeA:function(a,b,c){for(var d=0,e=E.length;d<e;d++)E[d].apply(this,arguments)},getCache:function(a){return w[a.treeId]},getNodeIndex:function(a,b){if(!b)return null;for(var c=a.data.key.children,d=b.parentTId?b.getParentNode():h.getRoot(a),e=0,f=d[c].length-1;e<=f;e++)if(d[c][e]===b)return e;return-1},getNextNode:function(a,b){if(!b)return null;for(var c=a.data.key.children,d=b.parentTId?b.getParentNode():h.getRoot(a),e=0,f=d[c].length-1;e<=f;e++)if(d[c][e]===b)return e==f?null:d[c][e+1];return null},getNodeByParam:function(a,b,c,d){if(!b||!c)return null;for(var e=a.data.key.children,f=0,g=b.length;f<g;f++){if(b[f][c]==d)return b[f];var i=h.getNodeByParam(a,b[f][e],c,d);if(i)return i}return null},getNodeCache:function(a,b){if(!b)return null;var c=w[a.treeId].nodes[h.getNodeCacheId(b)];return c?c:null},getNodeName:function(a,b){return""+b[a.data.key.name]},getNodePath:function(a,b){if(!b)return null;var c;return(c=b.parentTId?b.getParentNode().getPath():[])&&c.push(b),c},getNodeTitle:function(a,b){return""+b[""===a.data.key.title?a.data.key.name:a.data.key.title]},getNodes:function(a){return h.getRoot(a)[a.data.key.children]},getNodesByParam:function(a,b,c,d){if(!b||!c)return[];for(var e=a.data.key.children,f=[],g=0,i=b.length;g<i;g++)b[g][c]==d&&f.push(b[g]),f=f.concat(h.getNodesByParam(a,b[g][e],c,d));return f},getNodesByParamFuzzy:function(a,b,c,d){if(!b||!c)return[];for(var e=a.data.key.children,f=[],d=d.toLowerCase(),g=0,i=b.length;g<i;g++)"string"==typeof b[g][c]&&b[g][c].toLowerCase().indexOf(d)>-1&&f.push(b[g]),f=f.concat(h.getNodesByParamFuzzy(a,b[g][e],c,d));return f},getNodesByFilter:function(a,b,c,d,e){if(!b)return d?null:[];for(var f=a.data.key.children,g=d?null:[],i=0,k=b.length;i<k;i++){if(j.apply(c,[b[i],e],!1)){if(d)return b[i];g.push(b[i])}var l=h.getNodesByFilter(a,b[i][f],c,d,e);if(d&&l)return l;g=d?l:g.concat(l)}return g},getPreNode:function(a,b){if(!b)return null;for(var c=a.data.key.children,d=b.parentTId?b.getParentNode():h.getRoot(a),e=0,f=d[c].length;e<f;e++)if(d[c][e]===b)return 0==e?null:d[c][e-1];return null},getRoot:function(a){return a?v[a.treeId]:null},getRoots:function(){return v},getSetting:function(a){return r[a]},getSettings:function(){return r},getZTreeTools:function(a){return(a=this.getRoot(this.getSetting(a)))?a.treeTools:null},initCache:function(a){for(var b=0,c=z.length;b<c;b++)z[b].apply(this,arguments)},initNode:function(a,b,c,d,e,f){for(var g=0,h=A.length;g<h;g++)A[g].apply(this,arguments)},initRoot:function(a){for(var b=0,c=B.length;b<c;b++)B[b].apply(this,arguments)},isSelectedNode:function(a,b){for(var c=h.getRoot(a),d=0,e=c.curSelectedList.length;d<e;d++)if(b===c.curSelectedList[d])return!0;return!1},removeNodeCache:function(a,b){var c=a.data.key.children;if(b[c])for(var d=0,e=b[c].length;d<e;d++)h.removeNodeCache(a,b[c][d]);h.getCache(a).nodes[h.getNodeCacheId(b.tId)]=null},removeSelectedNode:function(a,b){for(var c=h.getRoot(a),d=0,e=c.curSelectedList.length;d<e;d++)b!==c.curSelectedList[d]&&h.getNodeCache(a,c.curSelectedList[d].tId)||(c.curSelectedList.splice(d,1),a.treeObj.trigger(f.event.UNSELECTED,[a.treeId,b]),d--,e--)},setCache:function(a,b){w[a.treeId]=b},setRoot:function(a,b){v[a.treeId]=b},setZTreeTools:function(a,b){for(var c=0,d=G.length;c<d;c++)G[c].apply(this,arguments)},transformToArrayFormat:function(a,b){if(!b)return[];var c=a.data.key.children,d=[];if(j.isArray(b))for(var e=0,f=b.length;e<f;e++)d.push(b[e]),b[e][c]&&(d=d.concat(h.transformToArrayFormat(a,b[e][c])));else d.push(b),b[c]&&(d=d.concat(h.transformToArrayFormat(a,b[c])));return d},transformTozTreeFormat:function(a,b){var c,d,e=a.data.simpleData.idKey,f=a.data.simpleData.pIdKey,g=a.data.key.children;if(!e||""==e||!b)return[];if(j.isArray(b)){var h=[],i={};for(c=0,d=b.length;c<d;c++)i[b[c][e]]=b[c];for(c=0,d=b.length;c<d;c++)i[b[c][f]]&&b[c][e]!=b[c][f]?(i[b[c][f]][g]||(i[b[c][f]][g]=[]),i[b[c][f]][g].push(b[c])):h.push(b[c]);return h}return[b]}},m={bindEvent:function(a){for(var b=0,c=x.length;b<c;b++)x[b].apply(this,arguments)},unbindEvent:function(a){for(var b=0,c=y.length;b<c;b++)y[b].apply(this,arguments)},bindTree:function(a){var b={treeId:a.treeId},c=a.treeObj;a.view.txtSelectedEnable||c.bind("selectstart",u).css({"-moz-user-select":"-moz-none"}),c.bind("click",b,m.proxy),c.bind("dblclick",b,m.proxy),c.bind("mouseover",b,m.proxy),c.bind("mouseout",b,m.proxy),c.bind("mousedown",b,m.proxy),c.bind("mouseup",b,m.proxy),c.bind("contextmenu",b,m.proxy)},unbindTree:function(a){a.treeObj.unbind("selectstart",u).unbind("click",m.proxy).unbind("dblclick",m.proxy).unbind("mouseover",m.proxy).unbind("mouseout",m.proxy).unbind("mousedown",m.proxy).unbind("mouseup",m.proxy).unbind("contextmenu",m.proxy)},doProxy:function(a){for(var b=[],c=0,d=t.length;c<d;c++){var e=t[c].apply(this,arguments);if(b.push(e),e.stop)break}return b},proxy:function(a){var b=h.getSetting(a.data.treeId);if(!j.uCanDo(b,a))return!0;for(var b=m.doProxy(a),c=!0,d=0,e=b.length;d<e;d++){var f=b[d];f.nodeEventCallback&&(c=f.nodeEventCallback.apply(f,[a,f.node])&&c),f.treeEventCallback&&(c=f.treeEventCallback.apply(f,[a,f.node])&&c)}return c}};H=function(a,b){var c=h.getSetting(a.data.treeId);if(b.open){if(0==j.apply(c.callback.beforeCollapse,[c.treeId,b],!0))return!0}else if(0==j.apply(c.callback.beforeExpand,[c.treeId,b],!0))return!0;return h.getRoot(c).expandTriggerFlag=!0,i.switchNode(c,b),!0},I=function(a,b){var c=h.getSetting(a.data.treeId),d=c.view.autoCancelSelected&&(a.ctrlKey||a.metaKey)&&h.isSelectedNode(c,b)?0:c.view.autoCancelSelected&&(a.ctrlKey||a.metaKey)&&c.view.selectedMulti?2:1;return 0==j.apply(c.callback.beforeClick,[c.treeId,b,d],!0)||(0===d?i.cancelPreSelectedNode(c,b):i.selectNode(c,b,2===d),c.treeObj.trigger(f.event.CLICK,[a,c.treeId,b,d]),!0)},J=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeMouseDown,[c.treeId,b],!0)&&j.apply(c.callback.onMouseDown,[a,c.treeId,b]),!0},K=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeMouseUp,[c.treeId,b],!0)&&j.apply(c.callback.onMouseUp,[a,c.treeId,b]),!0},L=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeDblClick,[c.treeId,b],!0)&&j.apply(c.callback.onDblClick,[a,c.treeId,b]),!0},M=function(a,b){var c=h.getSetting(a.data.treeId);return j.apply(c.callback.beforeRightClick,[c.treeId,b],!0)&&j.apply(c.callback.onRightClick,[a,c.treeId,b]),"function"!=typeof c.callback.onRightClick},u=function(a){return a=a.originalEvent.srcElement.nodeName.toLowerCase(),"input"===a||"textarea"===a};var j={apply:function(a,b,c){return"function"==typeof a?a.apply(O,b?b:[]):c},canAsync:function(a,b){var c=a.data.key.children;return a.async.enable&&b&&b.isParent&&!(b.zAsync||b[c]&&b[c].length>0)},clone:function(a){if(null===a)return null;var b,c=j.isArray(a)?[]:{};for(b in a)c[b]=a[b]instanceof Date?new Date(a[b].getTime()):"object"==typeof a[b]?j.clone(a[b]):a[b];return c},eqs:function(a,b){return a.toLowerCase()===b.toLowerCase()},isArray:function(a){return"[object Array]"===Object.prototype.toString.apply(a)},$:function(a,b,c){return b&&"string"!=typeof b&&(c=b,b=""),"string"==typeof a?q(a,c?c.treeObj.get(0).ownerDocument:null):q("#"+a.tId+b,c?c.treeObj:null)},getMDom:function(a,b,c){if(!b)return null;for(;b&&b.id!==a.treeId;){for(var d=0,e=c.length;b.tagName&&d<e;d++)if(j.eqs(b.tagName,c[d].tagName)&&null!==b.getAttribute(c[d].attrName))return b;b=b.parentNode}return null},getNodeMainDom:function(a){return q(a).parent("li").get(0)||q(a).parentsUntil("li").parent().get(0)},isChildOrSelf:function(a,b){return q(a).closest("#"+b).length>0},uCanDo:function(){return!0}},i={addNodes:function(a,b,c,d,e){if(!a.data.keep.leaf||!b||b.isParent)if(j.isArray(d)||(d=[d]),a.data.simpleData.enable&&(d=h.transformTozTreeFormat(a,d)),b){var g=k(b,f.id.SWITCH,a),l=k(b,f.id.ICON,a),m=k(b,f.id.UL,a);b.open||(i.replaceSwitchClass(b,g,f.folder.CLOSE),i.replaceIcoClass(b,l,f.folder.CLOSE),b.open=!1,m.css({display:"none"})),h.addNodesData(a,b,c,d),i.createNodes(a,b.level+1,d,b,c),e||i.expandCollapseParentNode(a,b,!0)}else h.addNodesData(a,h.getRoot(a),c,d),i.createNodes(a,0,d,null,c)},appendNodes:function(a,b,c,d,e,f,g){if(!c)return[];var j,k,l=[],m=a.data.key.children,n=(d?d:h.getRoot(a))[m];(!n||e>=n.length)&&(e=-1);for(var o=0,p=c.length;o<p;o++){var q=c[o];f&&(j=(0===e||n.length==c.length)&&0==o,k=e<0&&o==c.length-1,h.initNode(a,b,q,d,j,k,g),h.addNodeCache(a,q)),j=[],q[m]&&q[m].length>0&&(j=i.appendNodes(a,b+1,q[m],q,-1,f,g&&q.open)),g&&(i.makeDOMNodeMainBefore(l,a,q),i.makeDOMNodeLine(l,a,q),h.getBeforeA(a,q,l),i.makeDOMNodeNameBefore(l,a,q),h.getInnerBeforeA(a,q,l),i.makeDOMNodeIcon(l,a,q),h.getInnerAfterA(a,q,l),i.makeDOMNodeNameAfter(l,a,q),h.getAfterA(a,q,l),q.isParent&&q.open&&i.makeUlHtml(a,q,l,j.join("")),i.makeDOMNodeMainAfter(l,a,q),h.addCreatedNode(a,q))}return l},appendParentULDom:function(a,b){var c=[],d=k(b,a);!d.get(0)&&b.parentTId&&(i.appendParentULDom(a,b.getParentNode()),d=k(b,a));var e=k(b,f.id.UL,a);e.get(0)&&e.remove(),e=i.appendNodes(a,b.level+1,b[a.data.key.children],b,-1,!1,!0),i.makeUlHtml(a,b,c,e.join("")),d.append(c.join(""))},asyncNode:function(b,a,c,d){var e,g;if(a&&!a.isParent)return j.apply(d),!1;if(a&&a.isAjaxing)return!1;if(0==j.apply(b.callback.beforeAsync,[b.treeId,a],!0))return j.apply(d),!1;a&&(a.isAjaxing=!0,k(a,f.id.ICON,b).attr({style:"","class":f.className.BUTTON+" "+f.className.ICO_LOADING}));var l={};for(e=0,g=b.async.autoParam.length;a&&e<g;e++){var p=b.async.autoParam[e].split("="),n=p;p.length>1&&(n=p[1],p=p[0]),l[n]=a[p]}if(j.isArray(b.async.otherParam))for(e=0,g=b.async.otherParam.length;e<g;e+=2)l[b.async.otherParam[e]]=b.async.otherParam[e+1];else for(var m in b.async.otherParam)l[m]=b.async.otherParam[m];var P=h.getRoot(b)._ver;return q.ajax({contentType:b.async.contentType,cache:!1,type:b.async.type,url:j.apply(b.async.url,[b.treeId,a],b.async.url),data:b.async.contentType.indexOf("application/json")>-1?JSON.stringify(l):l,dataType:b.async.dataType,success:function(e){if(P==h.getRoot(b)._ver){var g=[];try{g=e&&0!=e.length?"string"==typeof e?eval("("+e+")"):e:[]}catch(l){g=e}a&&(a.isAjaxing=null,a.zAsync=!0),i.setNodeLineIcos(b,a),g&&""!==g?(g=j.apply(b.async.dataFilter,[b.treeId,a,g],g),i.addNodes(b,a,-1,g?j.clone(g):[],!!c)):i.addNodes(b,a,-1,[],!!c),b.treeObj.trigger(f.event.ASYNC_SUCCESS,[b.treeId,a,e]),j.apply(d)}},error:function(c,d,e){P==h.getRoot(b)._ver&&(a&&(a.isAjaxing=null),i.setNodeLineIcos(b,a),b.treeObj.trigger(f.event.ASYNC_ERROR,[b.treeId,a,c,d,e]))}}),!0},cancelPreSelectedNode:function(a,b,c){var d,e,g=h.getRoot(a).curSelectedList;for(d=g.length-1;d>=0;d--)if(e=g[d],b===e||!b&&(!c||c!==e)){if(k(e,f.id.A,a).removeClass(f.node.CURSELECTED),b){h.removeSelectedNode(a,b);break}g.splice(d,1),a.treeObj.trigger(f.event.UNSELECTED,[a.treeId,e])}},createNodeCallback:function(a){if(a.callback.onNodeCreated||a.view.addDiyDom)for(var b=h.getRoot(a);b.createdNodes.length>0;){var c=b.createdNodes.shift();j.apply(a.view.addDiyDom,[a.treeId,c]),a.callback.onNodeCreated&&a.treeObj.trigger(f.event.NODECREATED,[a.treeId,c])}},createNodes:function(a,b,c,d,e){if(c&&0!=c.length){var g=h.getRoot(a),j=a.data.key.children,j=!d||d.open||!!k(d[j][0],a).get(0);g.createdNodes=[];var l,m,b=i.appendNodes(a,b,c,d,e,!0,j);d?(d=k(d,f.id.UL,a),d.get(0)&&(l=d)):l=a.treeObj,l&&(e>=0&&(m=l.children()[e]),e>=0&&m?q(m).before(b.join("")):l.append(b.join(""))),i.createNodeCallback(a)}},destroy:function(a){a&&(h.initCache(a),h.initRoot(a),m.unbindTree(a),m.unbindEvent(a),a.treeObj.empty(),delete r[a.treeId])},expandCollapseNode:function(a,b,c,d,e){var g,l=h.getRoot(a),m=a.data.key.children;if(b)if(l.expandTriggerFlag&&(g=e,e=function(){g&&g(),b.open?a.treeObj.trigger(f.event.EXPAND,[a.treeId,b]):a.treeObj.trigger(f.event.COLLAPSE,[a.treeId,b])},l.expandTriggerFlag=!1),!b.open&&b.isParent&&(!k(b,f.id.UL,a).get(0)||b[m]&&b[m].length>0&&!k(b[m][0],a).get(0))&&(i.appendParentULDom(a,b),i.createNodeCallback(a)),b.open==c)j.apply(e,[]);else{var c=k(b,f.id.UL,a),l=k(b,f.id.SWITCH,a),n=k(b,f.id.ICON,a);b.isParent?(b.open=!b.open,b.iconOpen&&b.iconClose&&n.attr("style",i.makeNodeIcoStyle(a,b)),b.open?(i.replaceSwitchClass(b,l,f.folder.OPEN),i.replaceIcoClass(b,n,f.folder.OPEN),0==d||""==a.view.expandSpeed?(c.show(),j.apply(e,[])):b[m]&&b[m].length>0?c.slideDown(a.view.expandSpeed,e):(c.show(),j.apply(e,[]))):(i.replaceSwitchClass(b,l,f.folder.CLOSE),i.replaceIcoClass(b,n,f.folder.CLOSE),0!=d&&""!=a.view.expandSpeed&&b[m]&&b[m].length>0?c.slideUp(a.view.expandSpeed,e):(c.hide(),j.apply(e,[])))):j.apply(e,[])}else j.apply(e,[])},expandCollapseParentNode:function(a,b,c,d,e){b&&(b.parentTId?(i.expandCollapseNode(a,b,c,d),b.parentTId&&i.expandCollapseParentNode(a,b.getParentNode(),c,d,e)):i.expandCollapseNode(a,b,c,d,e))},expandCollapseSonNode:function(a,b,c,d,e){var f=h.getRoot(a),g=a.data.key.children,f=b?b[g]:f[g],g=!b&&d,j=h.getRoot(a).expandTriggerFlag;if(h.getRoot(a).expandTriggerFlag=!1,f)for(var k=0,l=f.length;k<l;k++)f[k]&&i.expandCollapseSonNode(a,f[k],c,g);h.getRoot(a).expandTriggerFlag=j,i.expandCollapseNode(a,b,c,d,e)},isSelectedNode:function(a,b){if(!b)return!1;var c,d=h.getRoot(a).curSelectedList;for(c=d.length-1;c>=0;c--)if(b===d[c])return!0;return!1},makeDOMNodeIcon:function(a,b,c){var d=h.getNodeName(b,c),d=b.view.nameIsHTML?d:d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");a.push("<span id='",c.tId,f.id.ICON,"' title='' treeNode",f.id.ICON," class='",i.makeNodeIcoClass(b,c),"' style='",i.makeNodeIcoStyle(b,c),"'></span><span id='",c.tId,f.id.SPAN,"' class='",f.className.NAME,"'>",d,"</span>")},makeDOMNodeLine:function(a,b,c){a.push("<span id='",c.tId,f.id.SWITCH,"' title='' class='",i.makeNodeLineClass(b,c),"' treeNode",f.id.SWITCH,"></span>")},makeDOMNodeMainAfter:function(a){a.push("</li>")},makeDOMNodeMainBefore:function(a,b,c){a.push("<li id='",c.tId,"' class='",f.className.LEVEL,c.level,"' tabindex='0' hidefocus='true' treenode>")},makeDOMNodeNameAfter:function(a){a.push("</a>")},makeDOMNodeNameBefore:function(a,b,c){var d,e=h.getNodeTitle(b,c),g=i.makeNodeUrl(b,c),k=i.makeNodeFontCss(b,c),l=[];for(d in k)l.push(d,":",k[d],";");a.push("<a id='",c.tId,f.id.A,"' class='",f.className.LEVEL,c.level,"' treeNode",f.id.A,' onclick="',c.click||"",'" ',null!=g&&g.length>0?"href='"+g+"'":""," target='",i.makeNodeTarget(c),"' style='",l.join(""),"'"),j.apply(b.view.showTitle,[b.treeId,c],b.view.showTitle)&&e&&a.push("title='",e.replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"'"),a.push(">")},makeNodeFontCss:function(a,b){var c=j.apply(a.view.fontCss,[a.treeId,b],a.view.fontCss);return c&&"function"!=typeof c?c:{}},makeNodeIcoClass:function(a,b){var c=["ico"];return b.isAjaxing||(c[0]=(b.iconSkin?b.iconSkin+"_":"")+c[0],b.isParent?c.push(b.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU)),f.className.BUTTON+" "+c.join("_")},makeNodeIcoStyle:function(a,b){var c=[];if(!b.isAjaxing){var d=b.isParent&&b.iconOpen&&b.iconClose?b.open?b.iconOpen:b.iconClose:b[a.data.key.icon];d&&c.push("background:url(",d,") 0 0 no-repeat;"),(0==a.view.showIcon||!j.apply(a.view.showIcon,[a.treeId,b],!0))&&c.push("width:0px;height:0px;")}return c.join("")},makeNodeLineClass:function(a,b){var c=[];return a.view.showLine?0==b.level&&b.isFirstNode&&b.isLastNode?c.push(f.line.ROOT):0==b.level&&b.isFirstNode?c.push(f.line.ROOTS):b.isLastNode?c.push(f.line.BOTTOM):c.push(f.line.CENTER):c.push(f.line.NOLINE),b.isParent?c.push(b.open?f.folder.OPEN:f.folder.CLOSE):c.push(f.folder.DOCU),i.makeNodeLineClassEx(b)+c.join("_")},makeNodeLineClassEx:function(a){return f.className.BUTTON+" "+f.className.LEVEL+a.level+" "+f.className.SWITCH+" "},makeNodeTarget:function(a){return a.target||"_blank"},makeNodeUrl:function(a,b){var c=a.data.key.url;return b[c]?b[c]:null},makeUlHtml:function(a,b,c,d){c.push("<ul id='",b.tId,f.id.UL,"' class='",f.className.LEVEL,b.level," ",i.makeUlLineClass(a,b),"' style='display:",b.open?"block":"none","'>"),c.push(d),c.push("</ul>")},makeUlLineClass:function(a,b){return a.view.showLine&&!b.isLastNode?f.line.LINE:""},removeChildNodes:function(a,b){if(b){var c=a.data.key.children,d=b[c];if(d){for(var e=0,g=d.length;e<g;e++)h.removeNodeCache(a,d[e]);h.removeSelectedNode(a),delete b[c],a.data.keep.parent?k(b,f.id.UL,a).empty():(b.isParent=!1,b.open=!1,c=k(b,f.id.SWITCH,a),d=k(b,f.id.ICON,a),i.replaceSwitchClass(b,c,f.folder.DOCU),i.replaceIcoClass(b,d,f.folder.DOCU),k(b,f.id.UL,a).remove())}}},scrollIntoView:function(a){a&&(Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(a){function b(a,c,d,f){return{left:a,top:c,width:d,height:f,right:a+d,bottom:c+f,translate:function(e,g){return b(e+a,g+c,d,f)},relativeFromTo:function(g,h){var i=a,j=c,g=g.offsetParent,h=h.offsetParent;if(g===h)return e;for(;g;g=g.offsetParent)i+=g.offsetLeft+g.clientLeft,j+=g.offsetTop+g.clientTop;for(;h;h=h.offsetParent)i-=h.offsetLeft+h.clientLeft,j-=h.offsetTop+h.clientTop;return b(i,j,d,f)}}}for(var c,d=this,e=b(this.offsetLeft,this.offsetTop,this.offsetWidth,this.offsetHeight);(c=d.parentNode)instanceof HTMLElement;){var f=c.offsetLeft+c.clientLeft,g=c.offsetTop+c.clientTop,e=e.relativeFromTo(d,c).translate(-f,-g);c.scrollLeft=!1===a||e.left<=c.scrollLeft+c.clientWidth&&c.scrollLeft<=e.right-c.clientWidth+c.clientWidth?Math.min(e.left,Math.max(e.right-c.clientWidth,c.scrollLeft)):(e.right-c.clientWidth+e.left)/2,c.scrollTop=!1===a||e.top<=c.scrollTop+c.clientHeight&&c.scrollTop<=e.bottom-c.clientHeight+c.clientHeight?Math.min(e.top,Math.max(e.bottom-c.clientHeight,c.scrollTop)):(e.bottom-c.clientHeight+e.top)/2,e=e.translate(f-c.scrollLeft,g-c.scrollTop),d=c}}),a.scrollIntoViewIfNeeded())},setFirstNode:function(a,b){var c=a.data.key.children;b[c].length>0&&(b[c][0].isFirstNode=!0)},setLastNode:function(a,b){var c=a.data.key.children,d=b[c].length;d>0&&(b[c][d-1].isLastNode=!0)},removeNode:function(a,b){var c=h.getRoot(a),d=a.data.key.children,e=b.parentTId?b.getParentNode():c;if(b.isFirstNode=!1,b.isLastNode=!1,b.getPreNode=function(){return null},b.getNextNode=function(){return null},h.getNodeCache(a,b.tId)){k(b,a).remove(),h.removeNodeCache(a,b),h.removeSelectedNode(a,b);for(var g=0,j=e[d].length;g<j;g++)if(e[d][g].tId==b.tId){e[d].splice(g,1);break}i.setFirstNode(a,e),i.setLastNode(a,e);var l,g=e[d].length;if(a.data.keep.parent||0!=g){if(a.view.showLine&&g>0){var m=e[d][g-1],g=k(m,f.id.UL,a),j=k(m,f.id.SWITCH,a);l=k(m,f.id.ICON,a),e==c?1==e[d].length?i.replaceSwitchClass(m,j,f.line.ROOT):(c=k(e[d][0],f.id.SWITCH,a),i.replaceSwitchClass(e[d][0],c,f.line.ROOTS),i.replaceSwitchClass(m,j,f.line.BOTTOM)):i.replaceSwitchClass(m,j,f.line.BOTTOM),g.removeClass(f.line.LINE)}}else e.isParent=!1,e.open=!1,g=k(e,f.id.UL,a),j=k(e,f.id.SWITCH,a),l=k(e,f.id.ICON,a),i.replaceSwitchClass(e,j,f.folder.DOCU),i.replaceIcoClass(e,l,f.folder.DOCU),g.css("display","none")}},replaceIcoClass:function(a,b,c){if(b&&!a.isAjaxing&&(a=b.attr("class"),void 0!=a)){switch(a=a.split("_"),c){case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:a[a.length-1]=c}b.attr("class",a.join("_"))}},replaceSwitchClass:function(a,b,c){if(b){var d=b.attr("class");if(void 0!=d){switch(d=d.split("_"),c){case f.line.ROOT:case f.line.ROOTS:case f.line.CENTER:case f.line.BOTTOM:case f.line.NOLINE:d[0]=i.makeNodeLineClassEx(a)+c;break;case f.folder.OPEN:case f.folder.CLOSE:case f.folder.DOCU:d[1]=c}b.attr("class",d.join("_")),c!==f.folder.DOCU?b.removeAttr("disabled"):b.attr("disabled","disabled")}}},selectNode:function(a,b,c){c||i.cancelPreSelectedNode(a,null,b),k(b,f.id.A,a).addClass(f.node.CURSELECTED),h.addSelectedNode(a,b),a.treeObj.trigger(f.event.SELECTED,[a.treeId,b])},setNodeFontCss:function(a,b){var c=k(b,f.id.A,a),d=i.makeNodeFontCss(a,b);d&&c.css(d)},setNodeLineIcos:function(a,b){if(b){var c=k(b,f.id.SWITCH,a),d=k(b,f.id.UL,a),e=k(b,f.id.ICON,a),g=i.makeUlLineClass(a,b);0==g.length?d.removeClass(f.line.LINE):d.addClass(g),c.attr("class",i.makeNodeLineClass(a,b)),b.isParent?c.removeAttr("disabled"):c.attr("disabled","disabled"),e.removeAttr("style"),e.attr("style",i.makeNodeIcoStyle(a,b)),e.attr("class",i.makeNodeIcoClass(a,b))}},setNodeName:function(a,b){var c=h.getNodeTitle(a,b),d=k(b,f.id.SPAN,a);d.empty(),a.view.nameIsHTML?d.html(h.getNodeName(a,b)):d.text(h.getNodeName(a,b)),j.apply(a.view.showTitle,[a.treeId,b],a.view.showTitle)&&k(b,f.id.A,a).attr("title",c?c:"")},setNodeTarget:function(a,b){k(b,f.id.A,a).attr("target",i.makeNodeTarget(b))},setNodeUrl:function(a,b){var c=k(b,f.id.A,a),d=i.makeNodeUrl(a,b);null==d||0==d.length?c.removeAttr("href"):c.attr("href",d)},switchNode:function(a,b){b.open||!j.canAsync(a,b)?i.expandCollapseNode(a,b,!b.open):a.async.enable?i.asyncNode(a,b)||i.expandCollapseNode(a,b,!b.open):b&&i.expandCollapseNode(a,b,!b.open)}};q.fn.zTree={consts:{className:{BUTTON:"button",LEVEL:"level",ICO_LOADING:"ico_loading",SWITCH:"switch",NAME:"node_name"},event:{NODECREATED:"ztree_nodeCreated",CLICK:"ztree_click",EXPAND:"ztree_expand",COLLAPSE:"ztree_collapse",ASYNC_SUCCESS:"ztree_async_success",ASYNC_ERROR:"ztree_async_error",REMOVE:"ztree_remove",SELECTED:"ztree_selected",UNSELECTED:"ztree_unselected"},id:{A:"_a",ICON:"_ico",SPAN:"_span",SWITCH:"_switch",UL:"_ul"},line:{ROOT:"root",ROOTS:"roots",CENTER:"center",BOTTOM:"bottom",NOLINE:"noline",LINE:"line"},folder:{OPEN:"open",CLOSE:"close",DOCU:"docu"},node:{CURSELECTED:"curSelectedNode"}},_z:{tools:j,view:i,event:m,data:h},getZTreeObj:function(a){return(a=h.getZTreeTools(a))?a:null},destroy:function(a){if(a&&a.length>0)i.destroy(h.getSetting(a));else for(var b in r)i.destroy(r[b])},init:function(a,b,c){var d=j.clone(N);return q.extend(!0,d,b),d.treeId=a.attr("id"),d.treeObj=a,d.treeObj.empty(),r[d.treeId]=d,"undefined"==typeof document.body.style.maxHeight&&(d.view.expandSpeed=""),h.initRoot(d),a=h.getRoot(d),b=d.data.key.children,c=c?j.clone(j.isArray(c)?c:[c]):[],a[b]=d.data.simpleData.enable?h.transformTozTreeFormat(d,c):c,h.initCache(d),m.unbindTree(d),m.bindTree(d),m.unbindEvent(d),m.bindEvent(d),c={setting:d,addNodes:function(a,b,c,e){function f(){i.addNodes(d,a,b,h,1==e)}if(a||(a=null),a&&!a.isParent&&d.data.keep.leaf)return null;var g=parseInt(b,10);if(isNaN(g)?(e=!!c,c=b,b=-1):b=g,!c)return null;var h=j.clone(j.isArray(c)?c:[c]);return j.canAsync(d,a)?i.asyncNode(d,a,e,f):f(),h},cancelSelectedNode:function(a){i.cancelPreSelectedNode(d,a)},destroy:function(){i.destroy(d)},expandAll:function(a){return a=!!a,i.expandCollapseSonNode(d,null,a,!0),a},expandNode:function(a,b,c,e,f){function g(){var b=k(a,d).get(0);b&&e!==!1&&i.scrollIntoView(b)}return a&&a.isParent?(b!==!0&&b!==!1&&(b=!a.open),(f=!!f)&&b&&0==j.apply(d.callback.beforeExpand,[d.treeId,a],!0)?null:f&&!b&&0==j.apply(d.callback.beforeCollapse,[d.treeId,a],!0)?null:(b&&a.parentTId&&i.expandCollapseParentNode(d,a.getParentNode(),b,!1),b!==a.open||c?(h.getRoot(d).expandTriggerFlag=f,!j.canAsync(d,a)&&c?i.expandCollapseSonNode(d,a,b,!0,g):(a.open=!b,i.switchNode(this.setting,a),g()),b):null)):null},getNodes:function(){return h.getNodes(d)},getNodeByParam:function(a,b,c){return a?h.getNodeByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b):null},getNodeByTId:function(a){return h.getNodeCache(d,a)},getNodesByParam:function(a,b,c){return a?h.getNodesByParam(d,c?c[d.data.key.children]:h.getNodes(d),a,b):null},getNodesByParamFuzzy:function(a,b,c){return a?h.getNodesByParamFuzzy(d,c?c[d.data.key.children]:h.getNodes(d),a,b):null},getNodesByFilter:function(a,b,c,e){return b=!!b,a&&"function"==typeof a?h.getNodesByFilter(d,c?c[d.data.key.children]:h.getNodes(d),a,b,e):b?null:[]},getNodeIndex:function(a){if(!a)return null;for(var b=d.data.key.children,c=a.parentTId?a.getParentNode():h.getRoot(d),e=0,f=c[b].length;e<f;e++)if(c[b][e]==a)return e;return-1},getSelectedNodes:function(){for(var a=[],b=h.getRoot(d).curSelectedList,c=0,e=b.length;c<e;c++)a.push(b[c]);return a},isSelectedNode:function(a){return h.isSelectedNode(d,a)},reAsyncChildNodes:function(a,b,c){if(this.setting.async.enable){var e=!a;if(e&&(a=h.getRoot(d)),"refresh"==b){for(var b=this.setting.data.key.children,g=0,j=a[b]?a[b].length:0;g<j;g++)h.removeNodeCache(d,a[b][g]);h.removeSelectedNode(d),a[b]=[],e?this.setting.treeObj.empty():k(a,f.id.UL,d).empty()}i.asyncNode(this.setting,e?null:a,!!c)}},refresh:function(){this.setting.treeObj.empty();var a=h.getRoot(d),b=a[d.data.key.children];h.initRoot(d),a[d.data.key.children]=b,h.initCache(d),i.createNodes(d,0,a[d.data.key.children],null,-1)},removeChildNodes:function(a){if(!a)return null;var b=a[d.data.key.children];return i.removeChildNodes(d,a),b?b:null},removeNode:function(a,b){a&&(b=!!b,b&&0==j.apply(d.callback.beforeRemove,[d.treeId,a],!0)||(i.removeNode(d,a),b&&this.setting.treeObj.trigger(f.event.REMOVE,[d.treeId,a])))},selectNode:function(a,b,c){function e(){if(!c){var b=k(a,d).get(0);i.scrollIntoView(b)}}if(a&&j.uCanDo(d)){if(b=d.view.selectedMulti&&b,a.parentTId)i.expandCollapseParentNode(d,a.getParentNode(),!0,!1,e);else if(!c)try{k(a,d).focus().blur()}catch(f){}i.selectNode(d,a,b)}},transformTozTreeNodes:function(a){return h.transformTozTreeFormat(d,a)},transformToArray:function(a){return h.transformToArrayFormat(d,a)},updateNode:function(a){a&&k(a,d).get(0)&&j.uCanDo(d)&&(i.setNodeName(d,a),i.setNodeTarget(d,a),i.setNodeUrl(d,a),i.setNodeLineIcos(d,a),i.setNodeFontCss(d,a))}},a.treeTools=c,h.setZTreeTools(d,c),a[b]&&a[b].length>0?i.createNodes(d,0,a[b],null,-1):d.async.enable&&d.async.url&&""!==d.async.url&&i.asyncNode(d),c}};var O=q.fn.zTree,k=j.$,f=O.consts}(jQuery),function(a){var b,c,d,e={event:{CHECK:"ztree_check"},id:{CHECK:"_check"},checkbox:{STYLE:"checkbox",DEFAULT:"chk",DISABLED:"disable",FALSE:"false",TRUE:"true",FULL:"full",PART:"part",FOCUS:"focus"},radio:{STYLE:"radio",TYPE_ALL:"all",TYPE_LEVEL:"level"}},f={check:{enable:!1,autoCheckTrigger:!1,chkStyle:e.checkbox.STYLE,nocheckInherit:!1,chkDisabledInherit:!1,radioType:e.radio.TYPE_LEVEL,chkboxType:{Y:"ps",N:"ps"}},data:{key:{checked:"checked"}},callback:{beforeCheck:null,onCheck:null}};b=function(a,b){if(b.chkDisabled===!0)return!1;var c=j.getSetting(a.data.treeId),d=c.data.key.checked;return 0==g.apply(c.callback.beforeCheck,[c.treeId,b],!0)||(b[d]=!b[d],i.checkNodeRelation(c,b),d=k(b,h.id.CHECK,c),i.setChkClass(c,d,b),i.repairParentChkClassWithSelf(c,b),c.treeObj.trigger(h.event.CHECK,[a,c.treeId,b]),
!0)},c=function(a,b){if(b.chkDisabled===!0)return!1;var c=j.getSetting(a.data.treeId),d=k(b,h.id.CHECK,c);return b.check_Focus=!0,i.setChkClass(c,d,b),!0},d=function(a,b){if(b.chkDisabled===!0)return!1;var c=j.getSetting(a.data.treeId),d=k(b,h.id.CHECK,c);return b.check_Focus=!1,i.setChkClass(c,d,b),!0},a.extend(!0,a.fn.zTree.consts,e),a.extend(!0,a.fn.zTree._z,{tools:{},view:{checkNodeRelation:function(a,b){var c,d,e,f=a.data.key.children,g=a.data.key.checked;if(c=h.radio,a.check.chkStyle==c.STYLE){var l=j.getRadioCheckedList(a);if(b[g])if(a.check.radioType==c.TYPE_ALL){for(d=l.length-1;d>=0;d--)c=l[d],c[g]&&c!=b&&(c[g]=!1,l.splice(d,1),i.setChkClass(a,k(c,h.id.CHECK,a),c),c.parentTId!=b.parentTId&&i.repairParentChkClassWithSelf(a,c));l.push(b)}else for(l=b.parentTId?b.getParentNode():j.getRoot(a),d=0,e=l[f].length;d<e;d++)c=l[f][d],c[g]&&c!=b&&(c[g]=!1,i.setChkClass(a,k(c,h.id.CHECK,a),c));else if(a.check.radioType==c.TYPE_ALL)for(d=0,e=l.length;d<e;d++)if(b==l[d]){l.splice(d,1);break}}else b[g]&&(!b[f]||0==b[f].length||a.check.chkboxType.Y.indexOf("s")>-1)&&i.setSonNodeCheckBox(a,b,!0),!b[g]&&(!b[f]||0==b[f].length||a.check.chkboxType.N.indexOf("s")>-1)&&i.setSonNodeCheckBox(a,b,!1),b[g]&&a.check.chkboxType.Y.indexOf("p")>-1&&i.setParentNodeCheckBox(a,b,!0),!b[g]&&a.check.chkboxType.N.indexOf("p")>-1&&i.setParentNodeCheckBox(a,b,!1)},makeChkClass:function(a,b){var c=a.data.key.checked,d=h.checkbox,e=h.radio,f="",f=b.chkDisabled===!0?d.DISABLED:b.halfCheck?d.PART:a.check.chkStyle==e.STYLE?b.check_Child_State<1?d.FULL:d.PART:b[c]?2===b.check_Child_State||b.check_Child_State===-1?d.FULL:d.PART:b.check_Child_State<1?d.FULL:d.PART,c=a.check.chkStyle+"_"+(b[c]?d.TRUE:d.FALSE)+"_"+f,c=b.check_Focus&&b.chkDisabled!==!0?c+"_"+d.FOCUS:c;return h.className.BUTTON+" "+d.DEFAULT+" "+c},repairAllChk:function(a,b){if(a.check.enable&&a.check.chkStyle===h.checkbox.STYLE)for(var c=a.data.key.checked,d=a.data.key.children,e=j.getRoot(a),f=0,g=e[d].length;f<g;f++){var k=e[d][f];k.nocheck!==!0&&k.chkDisabled!==!0&&(k[c]=b),i.setSonNodeCheckBox(a,k,b)}},repairChkClass:function(a,b){if(b&&(j.makeChkFlag(a,b),b.nocheck!==!0)){var c=k(b,h.id.CHECK,a);i.setChkClass(a,c,b)}},repairParentChkClass:function(a,b){if(b&&b.parentTId){var c=b.getParentNode();i.repairChkClass(a,c),i.repairParentChkClass(a,c)}},repairParentChkClassWithSelf:function(a,b){if(b){var c=a.data.key.children;b[c]&&b[c].length>0?i.repairParentChkClass(a,b[c][0]):i.repairParentChkClass(a,b)}},repairSonChkDisabled:function(a,b,c,d){if(b){var e=a.data.key.children;if(b.chkDisabled!=c&&(b.chkDisabled=c),i.repairChkClass(a,b),b[e]&&d)for(var f=0,g=b[e].length;f<g;f++)i.repairSonChkDisabled(a,b[e][f],c,d)}},repairParentChkDisabled:function(a,b,c,d){b&&(b.chkDisabled!=c&&d&&(b.chkDisabled=c),i.repairChkClass(a,b),i.repairParentChkDisabled(a,b.getParentNode(),c,d))},setChkClass:function(a,b,c){b&&(c.nocheck===!0?b.hide():b.show(),b.attr("class",i.makeChkClass(a,c)))},setParentNodeCheckBox:function(a,b,c,d){var e=a.data.key.children,f=a.data.key.checked,g=k(b,h.id.CHECK,a);if(d||(d=b),j.makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0&&(b[f]=c,i.setChkClass(a,g,b),a.check.autoCheckTrigger&&b!=d&&a.treeObj.trigger(h.event.CHECK,[null,a.treeId,b])),b.parentTId){if(g=!0,!c)for(var e=b.getParentNode()[e],l=0,m=e.length;l<m;l++)if(e[l].nocheck!==!0&&e[l].chkDisabled!==!0&&e[l][f]||(e[l].nocheck===!0||e[l].chkDisabled===!0)&&e[l].check_Child_State>0){g=!1;break}g&&i.setParentNodeCheckBox(a,b.getParentNode(),c,d)}},setSonNodeCheckBox:function(a,b,c,d){if(b){var e=a.data.key.children,f=a.data.key.checked,g=k(b,h.id.CHECK,a);d||(d=b);var l=!1;if(b[e])for(var m=0,n=b[e].length;m<n;m++){var o=b[e][m];i.setSonNodeCheckBox(a,o,c,d),o.chkDisabled===!0&&(l=!0)}b!=j.getRoot(a)&&b.chkDisabled!==!0&&(l&&b.nocheck!==!0&&j.makeChkFlag(a,b),b.nocheck!==!0&&b.chkDisabled!==!0?(b[f]=c,l||(b.check_Child_State=b[e]&&b[e].length>0?c?2:0:-1)):b.check_Child_State=-1,i.setChkClass(a,g,b),a.check.autoCheckTrigger&&b!=d&&b.nocheck!==!0&&b.chkDisabled!==!0&&a.treeObj.trigger(h.event.CHECK,[null,a.treeId,b]))}}},event:{},data:{getRadioCheckedList:function(a){for(var b=j.getRoot(a).radioCheckedList,c=0,d=b.length;c<d;c++)j.getNodeCache(a,b[c].tId)||(b.splice(c,1),c--,d--);return b},getCheckStatus:function(a,b){if(!a.check.enable||b.nocheck||b.chkDisabled)return null;var c=a.data.key.checked;return{checked:b[c],half:b.halfCheck?b.halfCheck:a.check.chkStyle==h.radio.STYLE?2===b.check_Child_State:b[c]?b.check_Child_State>-1&&b.check_Child_State<2:b.check_Child_State>0}},getTreeCheckedNodes:function(a,b,c,d){if(!b)return[];for(var e=a.data.key.children,f=a.data.key.checked,g=c&&a.check.chkStyle==h.radio.STYLE&&a.check.radioType==h.radio.TYPE_ALL,d=d?d:[],i=0,k=b.length;i<k&&(b[i].nocheck===!0||b[i].chkDisabled===!0||b[i][f]!=c||(d.push(b[i]),!g))&&(j.getTreeCheckedNodes(a,b[i][e],c,d),!(g&&d.length>0));i++);return d},getTreeChangeCheckedNodes:function(a,b,c){if(!b)return[];for(var d=a.data.key.children,e=a.data.key.checked,c=c?c:[],f=0,g=b.length;f<g;f++)b[f].nocheck!==!0&&b[f].chkDisabled!==!0&&b[f][e]!=b[f].checkedOld&&c.push(b[f]),j.getTreeChangeCheckedNodes(a,b[f][d],c);return c},makeChkFlag:function(a,b){if(b){var c=a.data.key.children,d=a.data.key.checked,e=-1;if(b[c])for(var f=0,g=b[c].length;f<g;f++){var i=b[c][f],j=-1;if(a.check.chkStyle==h.radio.STYLE){if(j=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?2:i[d]?2:i.check_Child_State>0?2:0,2==j){e=2;break}0==j&&(e=0)}else if(a.check.chkStyle==h.checkbox.STYLE){if(j=i.nocheck===!0||i.chkDisabled===!0?i.check_Child_State:i.halfCheck===!0?1:i[d]?i.check_Child_State===-1||2===i.check_Child_State?2:1:i.check_Child_State>0?1:0,1===j){e=1;break}if(2===j&&e>-1&&f>0&&j!==e){e=1;break}if(2===e&&j>-1&&j<2){e=1;break}j>-1&&(e=j)}}b.check_Child_State=e}}}});var a=a.fn.zTree,g=a._z.tools,h=a.consts,i=a._z.view,j=a._z.data,k=g.$;j.exSetting(f),j.addInitBind(function(a){a.treeObj.bind(h.event.CHECK,function(b,c,d,e){b.srcEvent=c,g.apply(a.callback.onCheck,[b,d,e])})}),j.addInitUnBind(function(a){a.treeObj.unbind(h.event.CHECK)}),j.addInitCache(function(){}),j.addInitNode(function(a,b,c,d){c&&(b=a.data.key.checked,"string"==typeof c[b]&&(c[b]=g.eqs(c[b],"true")),c[b]=!!c[b],c.checkedOld=c[b],"string"==typeof c.nocheck&&(c.nocheck=g.eqs(c.nocheck,"true")),c.nocheck=!!c.nocheck||a.check.nocheckInherit&&d&&!!d.nocheck,"string"==typeof c.chkDisabled&&(c.chkDisabled=g.eqs(c.chkDisabled,"true")),c.chkDisabled=!!c.chkDisabled||a.check.chkDisabledInherit&&d&&!!d.chkDisabled,"string"==typeof c.halfCheck&&(c.halfCheck=g.eqs(c.halfCheck,"true")),c.halfCheck=!!c.halfCheck,c.check_Child_State=-1,c.check_Focus=!1,c.getCheckStatus=function(){return j.getCheckStatus(a,c)},a.check.chkStyle==h.radio.STYLE&&a.check.radioType==h.radio.TYPE_ALL&&c[b]&&j.getRoot(a).radioCheckedList.push(c))}),j.addInitProxy(function(a){var e=a.target,f=j.getSetting(a.data.treeId),i="",k=null,l="",m=null;if(g.eqs(a.type,"mouseover")?f.check.enable&&g.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+h.id.CHECK)&&(i=g.getNodeMainDom(e).id,l="mouseoverCheck"):g.eqs(a.type,"mouseout")?f.check.enable&&g.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+h.id.CHECK)&&(i=g.getNodeMainDom(e).id,l="mouseoutCheck"):g.eqs(a.type,"click")&&f.check.enable&&g.eqs(e.tagName,"span")&&null!==e.getAttribute("treeNode"+h.id.CHECK)&&(i=g.getNodeMainDom(e).id,l="checkNode"),i.length>0)switch(k=j.getNodeCache(f,i),l){case"checkNode":m=b;break;case"mouseoverCheck":m=c;break;case"mouseoutCheck":m=d}return{stop:"checkNode"===l,node:k,nodeEventType:l,nodeEventCallback:m,treeEventType:"",treeEventCallback:null}},!0),j.addInitRoot(function(a){j.getRoot(a).radioCheckedList=[]}),j.addBeforeA(function(a,b,c){a.check.enable&&(j.makeChkFlag(a,b),c.push("<span ID='",b.tId,h.id.CHECK,"' class='",i.makeChkClass(a,b),"' treeNode",h.id.CHECK,b.nocheck===!0?" style='display:none;'":"","></span>"))}),j.addZTreeTools(function(a,b){b.checkNode=function(a,b,c,d){var e=this.setting.data.key.checked;a.chkDisabled===!0||(b!==!0&&b!==!1&&(b=!a[e]),d=!!d,a[e]===b&&!c||d&&0==g.apply(this.setting.callback.beforeCheck,[this.setting.treeId,a],!0)||!g.uCanDo(this.setting)||!this.setting.check.enable||a.nocheck===!0)||(a[e]=b,b=k(a,h.id.CHECK,this.setting),(c||this.setting.check.chkStyle===h.radio.STYLE)&&i.checkNodeRelation(this.setting,a),i.setChkClass(this.setting,b,a),i.repairParentChkClassWithSelf(this.setting,a),d&&this.setting.treeObj.trigger(h.event.CHECK,[null,this.setting.treeId,a]))},b.checkAllNodes=function(a){i.repairAllChk(this.setting,!!a)},b.getCheckedNodes=function(a){var b=this.setting.data.key.children;return j.getTreeCheckedNodes(this.setting,j.getRoot(this.setting)[b],a!==!1)},b.getChangeCheckedNodes=function(){var a=this.setting.data.key.children;return j.getTreeChangeCheckedNodes(this.setting,j.getRoot(this.setting)[a])},b.setChkDisabled=function(a,b,c,d){b=!!b,c=!!c,i.repairSonChkDisabled(this.setting,a,b,!!d),i.repairParentChkDisabled(this.setting,a.getParentNode(),b,c)};var c=b.updateNode;b.updateNode=function(a,d){if(c&&c.apply(b,arguments),a&&this.setting.check.enable&&k(a,this.setting).get(0)&&g.uCanDo(this.setting)){var e=k(a,h.id.CHECK,this.setting);(1==d||this.setting.check.chkStyle===h.radio.STYLE)&&i.checkNodeRelation(this.setting,a),i.setChkClass(this.setting,e,a),i.repairParentChkClassWithSelf(this.setting,a)}}});var l=i.createNodes;i.createNodes=function(a,b,c,d,e){l&&l.apply(i,arguments),c&&i.repairParentChkClassWithSelf(a,d)};var m=i.removeNode;i.removeNode=function(a,b){var c=b.getParentNode();m&&m.apply(i,arguments),b&&c&&(i.repairChkClass(a,c),i.repairParentChkClass(a,c))};var n=i.appendNodes;i.appendNodes=function(a,b,c,d,e,f,g){var h="";return n&&(h=n.apply(i,arguments)),d&&j.makeChkFlag(a,d),h}}(jQuery),function(a){var b={event:{DRAG:"ztree_drag",DROP:"ztree_drop",RENAME:"ztree_rename",DRAGMOVE:"ztree_dragmove"},id:{EDIT:"_edit",INPUT:"_input",REMOVE:"_remove"},move:{TYPE_INNER:"inner",TYPE_PREV:"prev",TYPE_NEXT:"next"},node:{CURSELECTED_EDIT:"curSelectedNode_Edit",TMPTARGET_TREE:"tmpTargetzTree",TMPTARGET_NODE:"tmpTargetNode"}},c={onHoverOverNode:function(a,b){var d=h.getSetting(a.data.treeId),e=h.getRoot(d);e.curHoverNode!=b&&c.onHoverOutNode(a),e.curHoverNode=b,g.addHoverDom(d,b)},onHoverOutNode:function(a){var a=h.getSetting(a.data.treeId),b=h.getRoot(a);b.curHoverNode&&!h.isSelectedNode(a,b.curHoverNode)&&(g.removeTreeDom(a,b.curHoverNode),b.curHoverNode=null)},onMousedownNode:function(c,d){function j(c){if(0==p.dragFlag&&Math.abs(I-c.clientX)<o.edit.drag.minMoveSize&&Math.abs(J-c.clientY)<o.edit.drag.minMoveSize)return!0;var d,j,l,m,n;if(n=o.data.key.children,A.css("cursor","pointer"),0==p.dragFlag){if(0==e.apply(o.callback.beforeDrag,[o.treeId,t],!0))return k(c),!0;for(d=0,j=t.length;d<j;d++)0==d&&(p.dragNodeShowBefore=[]),l=t[d],l.isParent&&l.open?(g.expandCollapseNode(o,l,!l.open),p.dragNodeShowBefore[l.tId]=!0):p.dragNodeShowBefore[l.tId]=!1;if(p.dragFlag=1,q.showHoverDom=!1,e.showIfameMask(o,!0),l=!0,m=-1,t.length>1){var r=t[0].parentTId?t[0].getParentNode()[n]:h.getNodes(o);for(n=[],d=0,j=r.length;d<j;d++)if(void 0!==p.dragNodeShowBefore[r[d].tId]&&(l&&m>-1&&m+1!==d&&(l=!1),n.push(r[d]),m=d),t.length===n.length){t=n;break}}for(l&&(x=t[0].getPreNode(),y=t[t.length-1].getNextNode()),u=i("<ul class='zTreeDragUL'></ul>",o),d=0,j=t.length;d<j;d++)l=t[d],l.editNameFlag=!1,g.selectNode(o,l,d>0),g.removeTreeDom(o,l),d>o.edit.drag.maxShowNodeNum-1||(m=i("<li id='"+l.tId+"_tmp'></li>",o),m.append(i(l,f.id.A,o).clone()),m.css("padding","0"),m.children("#"+l.tId+f.id.A).removeClass(f.node.CURSELECTED),u.append(m),d==o.edit.drag.maxShowNodeNum-1&&(m=i("<li id='"+l.tId+"_moretmp'><a>  ...  </a></li>",o),u.append(m)));u.attr("id",t[0].tId+f.id.UL+"_tmp"),u.addClass(o.treeObj.attr("class")),u.appendTo(A),v=i("<span class='tmpzTreeMove_arrow'></span>",o),v.attr("id","zTreeMove_arrow_tmp"),v.appendTo(A),o.treeObj.trigger(f.event.DRAG,[c,o.treeId,t])}if(1==p.dragFlag){w&&v.attr("id")==c.target.id&&G&&c.clientX+z.scrollLeft()+2>a("#"+G+f.id.A,w).offset().left?(l=a("#"+G+f.id.A,w),c.target=l.length>0?l.get(0):c.target):w&&(w.removeClass(f.node.TMPTARGET_TREE),G&&a("#"+G+f.id.A,w).removeClass(f.node.TMPTARGET_NODE+"_"+f.move.TYPE_PREV).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER)),G=w=null,B=!1,C=o,l=h.getSettings();for(var s in l)l[s].treeId&&l[s].edit.enable&&l[s].treeId!=o.treeId&&(c.target.id==l[s].treeId||a(c.target).parents("#"+l[s].treeId).length>0)&&(B=!0,C=l[s]);s=z.scrollTop(),m=z.scrollLeft(),n=C.treeObj.offset(),d=C.treeObj.get(0).scrollHeight,l=C.treeObj.get(0).scrollWidth,j=c.clientY+s-n.top;var D=C.treeObj.height()+n.top-c.clientY-s,L=c.clientX+m-n.left,M=C.treeObj.width()+n.left-c.clientX-m;n=j<o.edit.drag.borderMax&&j>o.edit.drag.borderMin;var r=D<o.edit.drag.borderMax&&D>o.edit.drag.borderMin,N=L<o.edit.drag.borderMax&&L>o.edit.drag.borderMin,O=M<o.edit.drag.borderMax&&M>o.edit.drag.borderMin,D=j>o.edit.drag.borderMin&&D>o.edit.drag.borderMin&&L>o.edit.drag.borderMin&&M>o.edit.drag.borderMin,L=n&&C.treeObj.scrollTop()<=0,M=r&&C.treeObj.scrollTop()+C.treeObj.height()+10>=d,P=N&&C.treeObj.scrollLeft()<=0,Q=O&&C.treeObj.scrollLeft()+C.treeObj.width()+10>=l;if(c.target&&e.isChildOrSelf(c.target,C.treeId)){for(var R=c.target;R&&R.tagName&&!e.eqs(R.tagName,"li")&&R.id!=C.treeId;)R=R.parentNode;var S=!0;for(d=0,j=t.length;d<j;d++){if(l=t[d],R.id===l.tId){S=!1;break}if(i(l,o).find("#"+R.id).length>0){S=!1;break}}S&&c.target&&e.isChildOrSelf(c.target,R.id+f.id.A)&&(w=a(R),G=R.id)}if(l=t[0],D&&e.isChildOrSelf(c.target,C.treeId)&&(!w&&(c.target.id==C.treeId||L||M||P||Q)&&(B||!B&&l.parentTId)&&(w=C.treeObj),n?C.treeObj.scrollTop(C.treeObj.scrollTop()-10):r&&C.treeObj.scrollTop(C.treeObj.scrollTop()+10),N?C.treeObj.scrollLeft(C.treeObj.scrollLeft()-10):O&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+10),w&&w!=C.treeObj&&w.offset().left<C.treeObj.offset().left&&C.treeObj.scrollLeft(C.treeObj.scrollLeft()+w.offset().left-C.treeObj.offset().left)),u.css({top:c.clientY+s+3+"px",left:c.clientX+m+3+"px"}),j=d=0,w&&w.attr("id")!=C.treeId){var T=null==G?null:h.getNodeCache(C,G);n=(c.ctrlKey||c.metaKey)&&o.edit.drag.isMove&&o.edit.drag.isCopy||!o.edit.drag.isMove&&o.edit.drag.isCopy,m=!(!x||G!==x.tId),N=!(!y||G!==y.tId),r=l.parentTId&&l.parentTId==G,l=(n||!N)&&e.apply(C.edit.drag.prev,[C.treeId,t,T],!!C.edit.drag.prev),m=(n||!m)&&e.apply(C.edit.drag.next,[C.treeId,t,T],!!C.edit.drag.next),n=(n||!r)&&!(C.data.keep.leaf&&!T.isParent)&&e.apply(C.edit.drag.inner,[C.treeId,t,T],!!C.edit.drag.inner),r=function(){w=null,G="",H=f.move.TYPE_INNER,v.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null)},l||m||n?(N=a("#"+G+f.id.A,w),O=T.isLastNode?null:a("#"+T.getNextNode().tId+f.id.A,w.next()),D=N.offset().top,L=N.offset().left,M=l?n?.25:m?.5:1:-1,P=m?n?.75:l?.5:0:-1,s=(c.clientY+s-D)/N.height(),(1==M||s<=M&&s>=-.2)&&l?(d=1-v.width(),j=D-v.height()/2,H=f.move.TYPE_PREV):(0==P||s>=P&&s<=1.2)&&m?(d=1-v.width(),j=null==O||T.isParent&&T.open?D+N.height()-v.height()/2:O.offset().top-v.height()/2,H=f.move.TYPE_NEXT):n?(d=5-v.width(),j=D,H=f.move.TYPE_INNER):r(),w&&(v.css({display:"block",top:j+"px",left:L+d+"px"}),N.addClass(f.node.TMPTARGET_NODE+"_"+H),E==G&&F==H||(K=(new Date).getTime()),T&&T.isParent&&H==f.move.TYPE_INNER&&(s=!0,window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId!==T.tId?(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null):window.zTreeMoveTimer&&window.zTreeMoveTargetNodeTId===T.tId&&(s=!1),s)&&(window.zTreeMoveTimer=setTimeout(function(){H==f.move.TYPE_INNER&&T&&T.isParent&&!T.open&&(new Date).getTime()-K>C.edit.drag.autoOpenTime&&e.apply(C.callback.beforeDragOpen,[C.treeId,T],!0)&&(g.switchNode(C,T),C.edit.drag.autoExpandTrigger&&C.treeObj.trigger(f.event.EXPAND,[C.treeId,T]))},C.edit.drag.autoOpenTime+50),window.zTreeMoveTargetNodeTId=T.tId))):r()}else H=f.move.TYPE_INNER,w&&e.apply(C.edit.drag.inner,[C.treeId,t,null],!!C.edit.drag.inner)?w.addClass(f.node.TMPTARGET_TREE):w=null,v.css({display:"none"}),window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null);E=G,F=H,o.treeObj.trigger(f.event.DRAGMOVE,[c,o.treeId,t])}return!1}function k(c){if(window.zTreeMoveTimer&&(clearTimeout(window.zTreeMoveTimer),window.zTreeMoveTargetNodeTId=null),F=E=null,z.unbind("mousemove",j),z.unbind("mouseup",k),z.unbind("selectstart",l),A.css("cursor","auto"),w&&(w.removeClass(f.node.TMPTARGET_TREE),G&&a("#"+G+f.id.A,w).removeClass(f.node.TMPTARGET_NODE+"_"+f.move.TYPE_PREV).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_NEXT).removeClass(f.node.TMPTARGET_NODE+"_"+b.move.TYPE_INNER)),e.showIfameMask(o,!1),q.showHoverDom=!0,0!=p.dragFlag){p.dragFlag=0;var d,m,n;for(d=0,m=t.length;d<m;d++)n=t[d],n.isParent&&p.dragNodeShowBefore[n.tId]&&!n.open&&(g.expandCollapseNode(o,n,!n.open),delete p.dragNodeShowBefore[n.tId]);u&&u.remove(),v&&v.remove();var r=(c.ctrlKey||c.metaKey)&&o.edit.drag.isMove&&o.edit.drag.isCopy||!o.edit.drag.isMove&&o.edit.drag.isCopy;if(!r&&w&&G&&t[0].parentTId&&G==t[0].parentTId&&H==f.move.TYPE_INNER&&(w=null),w){var s=null==G?null:h.getNodeCache(C,G);if(0==e.apply(o.callback.beforeDrop,[C.treeId,t,s,H,r],!0))g.selectNodes(D,t);else{var x=r?e.clone(t):t;d=function(){if(B){if(!r)for(var a=0,b=t.length;a<b;a++)g.removeNode(o,t[a]);H==f.move.TYPE_INNER?g.addNodes(C,s,-1,x):g.addNodes(C,s.getParentNode(),H==f.move.TYPE_PREV?s.getIndex():s.getIndex()+1,x)}else if(r&&H==f.move.TYPE_INNER)g.addNodes(C,s,-1,x);else if(r)g.addNodes(C,s.getParentNode(),H==f.move.TYPE_PREV?s.getIndex():s.getIndex()+1,x);else if(H!=f.move.TYPE_NEXT)for(a=0,b=x.length;a<b;a++)g.moveNode(C,s,x[a],H,!1);else for(a=-1,b=x.length-1;a<b;b--)g.moveNode(C,s,x[b],H,!1);g.selectNodes(C,x),a=i(x[0],o).get(0),g.scrollIntoView(a),o.treeObj.trigger(f.event.DROP,[c,C.treeId,x,s,H,r])},H==f.move.TYPE_INNER&&e.canAsync(C,s)?g.asyncNode(C,s,!1,d):d()}}else g.selectNodes(D,t),o.treeObj.trigger(f.event.DROP,[c,o.treeId,t,null,null,null])}}function l(){return!1}var m,n,o=h.getSetting(c.data.treeId),p=h.getRoot(o),q=h.getRoots();if(2==c.button||!o.edit.enable||!o.edit.drag.isCopy&&!o.edit.drag.isMove)return!0;var r=c.target,s=h.getRoot(o).curSelectedList,t=[];if(h.isSelectedNode(o,d))for(m=0,n=s.length;m<n;m++){if(s[m].editNameFlag&&e.eqs(r.tagName,"input")&&null!==r.getAttribute("treeNode"+f.id.INPUT))return!0;if(t.push(s[m]),t[0].parentTId!==s[m].parentTId){t=[d];break}}else t=[d];g.editNodeBlur=!0,g.cancelCurEditNode(o);var u,v,w,x,y,z=a(o.treeObj.get(0).ownerDocument),A=a(o.treeObj.get(0).ownerDocument.body),B=!1,C=o,D=o,E=null,F=null,G=null,H=f.move.TYPE_INNER,I=c.clientX,J=c.clientY,K=(new Date).getTime();return e.uCanDo(o)&&z.bind("mousemove",j),z.bind("mouseup",k),z.bind("selectstart",l),c.preventDefault&&c.preventDefault(),!0}};a.extend(!0,a.fn.zTree.consts,b),a.extend(!0,a.fn.zTree._z,{tools:{getAbs:function(a){return a=a.getBoundingClientRect(),[a.left+(document.body.scrollLeft+document.documentElement.scrollLeft),a.top+(document.body.scrollTop+document.documentElement.scrollTop)]},inputFocus:function(a){a.get(0)&&(a.focus(),e.setCursorPosition(a.get(0),a.val().length))},inputSelect:function(a){a.get(0)&&(a.focus(),a.select())},setCursorPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},showIfameMask:function(a,b){for(var c=h.getRoot(a);c.dragMaskList.length>0;)c.dragMaskList[0].remove(),c.dragMaskList.shift();if(b)for(var d=i("iframe",a),f=0,g=d.length;f<g;f++){var j=d.get(f),k=e.getAbs(j),j=i("<div id='zTreeMask_"+f+"' class='zTreeMask' style='top:"+k[1]+"px; left:"+k[0]+"px; width:"+j.offsetWidth+"px; height:"+j.offsetHeight+"px;'></div>",a);j.appendTo(i("body",a)),c.dragMaskList.push(j)}}},view:{addEditBtn:function(a,b){if(!(b.editNameFlag||i(b,f.id.EDIT,a).length>0)&&e.apply(a.edit.showRenameBtn,[a.treeId,b],a.edit.showRenameBtn)){var c=i(b,f.id.A,a),d="<span class='"+f.className.BUTTON+" edit' id='"+b.tId+f.id.EDIT+"' title='"+e.apply(a.edit.renameTitle,[a.treeId,b],a.edit.renameTitle)+"' treeNode"+f.id.EDIT+" style='display:none;'></span>";c.append(d),i(b,f.id.EDIT,a).bind("click",function(){return!(!e.uCanDo(a)||0==e.apply(a.callback.beforeEditName,[a.treeId,b],!0))&&(g.editNode(a,b),!1)}).show()}},addRemoveBtn:function(a,b){if(!(b.editNameFlag||i(b,f.id.REMOVE,a).length>0)&&e.apply(a.edit.showRemoveBtn,[a.treeId,b],a.edit.showRemoveBtn)){var c=i(b,f.id.A,a),d="<span class='"+f.className.BUTTON+" remove' id='"+b.tId+f.id.REMOVE+"' title='"+e.apply(a.edit.removeTitle,[a.treeId,b],a.edit.removeTitle)+"' treeNode"+f.id.REMOVE+" style='display:none;'></span>";c.append(d),i(b,f.id.REMOVE,a).bind("click",function(){return!(!e.uCanDo(a)||0==e.apply(a.callback.beforeRemove,[a.treeId,b],!0))&&(g.removeNode(a,b),a.treeObj.trigger(f.event.REMOVE,[a.treeId,b]),!1)}).bind("mousedown",function(){return!0}).show()}},addHoverDom:function(a,b){h.getRoots().showHoverDom&&(b.isHover=!0,a.edit.enable&&(g.addEditBtn(a,b),g.addRemoveBtn(a,b)),e.apply(a.view.addHoverDom,[a.treeId,b]))},cancelCurEditNode:function(a,b,c){var d=h.getRoot(a),j=a.data.key.name,k=d.curEditNode;if(k){var l=d.curEditInput,b=b?b:c?k[j]:l.val();if(e.apply(a.callback.beforeRename,[a.treeId,k,b,c],!0)===!1)return!1;k[j]=b,i(k,f.id.A,a).removeClass(f.node.CURSELECTED_EDIT),l.unbind(),g.setNodeName(a,k),k.editNameFlag=!1,d.curEditNode=null,d.curEditInput=null,g.selectNode(a,k,!1),a.treeObj.trigger(f.event.RENAME,[a.treeId,k,c])}return d.noSelection=!0},editNode:function(a,b){var c=h.getRoot(a);if(g.editNodeBlur=!1,h.isSelectedNode(a,b)&&c.curEditNode==b&&b.editNameFlag)setTimeout(function(){e.inputFocus(c.curEditInput)},0);else{var d=a.data.key.name;b.editNameFlag=!0,g.removeTreeDom(a,b),g.cancelCurEditNode(a),g.selectNode(a,b,!1),i(b,f.id.SPAN,a).html("<input type=text class='rename' id='"+b.tId+f.id.INPUT+"' treeNode"+f.id.INPUT+" >");var j=i(b,f.id.INPUT,a);j.attr("value",b[d]),a.edit.editNameSelectAll?e.inputSelect(j):e.inputFocus(j),j.bind("blur",function(){g.editNodeBlur||g.cancelCurEditNode(a)}).bind("keydown",function(b){"13"==b.keyCode?(g.editNodeBlur=!0,g.cancelCurEditNode(a)):"27"==b.keyCode&&g.cancelCurEditNode(a,null,!0)}).bind("click",function(){return!1}).bind("dblclick",function(){return!1}),i(b,f.id.A,a).addClass(f.node.CURSELECTED_EDIT),c.curEditInput=j,c.noSelection=!1,c.curEditNode=b}},moveNode:function(a,b,c,d,e,j){var k=h.getRoot(a),l=a.data.key.children;if(b!=c&&(!a.data.keep.leaf||!b||b.isParent||d!=f.move.TYPE_INNER)){var m=c.parentTId?c.getParentNode():k,n=null===b||b==k;n&&null===b&&(b=k),n&&(d=f.move.TYPE_INNER),k=b.parentTId?b.getParentNode():k,d!=f.move.TYPE_PREV&&d!=f.move.TYPE_NEXT&&(d=f.move.TYPE_INNER),d==f.move.TYPE_INNER&&(n?c.parentTId=null:(b.isParent||(b.isParent=!0,b.open=!!b.open,g.setNodeLineIcos(a,b)),c.parentTId=b.tId));var o;n?o=n=a.treeObj:(j||d!=f.move.TYPE_INNER?j||g.expandCollapseNode(a,b.getParentNode(),!0,!1):g.expandCollapseNode(a,b,!0,!1),n=i(b,a),o=i(b,f.id.UL,a),n.get(0)&&!o.get(0)&&(o=[],g.makeUlHtml(a,b,o,""),n.append(o.join(""))),o=i(b,f.id.UL,a));var p=i(c,a);p.get(0)?n.get(0)||p.remove():p=g.appendNodes(a,c.level,[c],null,-1,!1,!0).join(""),o.get(0)&&d==f.move.TYPE_INNER?o.append(p):n.get(0)&&d==f.move.TYPE_PREV?n.before(p):n.get(0)&&d==f.move.TYPE_NEXT&&n.after(p);var q=-1,r=0,s=null,n=null,t=c.level;if(c.isFirstNode)q=0,m[l].length>1&&(s=m[l][1],s.isFirstNode=!0);else if(c.isLastNode)q=m[l].length-1,s=m[l][q-1],s.isLastNode=!0;else for(o=0,p=m[l].length;o<p;o++)if(m[l][o].tId==c.tId){q=o;break}if(q>=0&&m[l].splice(q,1),d!=f.move.TYPE_INNER)for(o=0,p=k[l].length;o<p;o++)k[l][o].tId==b.tId&&(r=o);d==f.move.TYPE_INNER?(b[l]||(b[l]=[]),b[l].length>0&&(n=b[l][b[l].length-1],n.isLastNode=!1),b[l].splice(b[l].length,0,c),c.isLastNode=!0,c.isFirstNode=1==b[l].length):b.isFirstNode&&d==f.move.TYPE_PREV?(k[l].splice(r,0,c),n=b,n.isFirstNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!0,c.isLastNode=!1):b.isLastNode&&d==f.move.TYPE_NEXT?(k[l].splice(r+1,0,c),n=b,n.isLastNode=!1,c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!0):(d==f.move.TYPE_PREV?k[l].splice(r,0,c):k[l].splice(r+1,0,c),c.parentTId=b.parentTId,c.isFirstNode=!1,c.isLastNode=!1),h.fixPIdKeyValue(a,c),h.setSonNodeLevel(a,c.getParentNode(),c),g.setNodeLineIcos(a,c),g.repairNodeLevelClass(a,c,t),!a.data.keep.parent&&m[l].length<1?(m.isParent=!1,m.open=!1,b=i(m,f.id.UL,a),d=i(m,f.id.SWITCH,a),l=i(m,f.id.ICON,a),g.replaceSwitchClass(m,d,f.folder.DOCU),g.replaceIcoClass(m,l,f.folder.DOCU),b.css("display","none")):s&&g.setNodeLineIcos(a,s),n&&g.setNodeLineIcos(a,n),a.check&&a.check.enable&&g.repairChkClass&&(g.repairChkClass(a,m),g.repairParentChkClassWithSelf(a,m),m!=c.parent&&g.repairParentChkClassWithSelf(a,c)),j||g.expandCollapseParentNode(a,c.getParentNode(),!0,e)}},removeEditBtn:function(a,b){i(b,f.id.EDIT,a).unbind().remove()},removeRemoveBtn:function(a,b){i(b,f.id.REMOVE,a).unbind().remove()},removeTreeDom:function(a,b){b.isHover=!1,g.removeEditBtn(a,b),g.removeRemoveBtn(a,b),e.apply(a.view.removeHoverDom,[a.treeId,b])},repairNodeLevelClass:function(a,b,c){if(c!==b.level){var d=i(b,a),e=i(b,f.id.A,a),a=i(b,f.id.UL,a),c=f.className.LEVEL+c,b=f.className.LEVEL+b.level;d.removeClass(c),d.addClass(b),e.removeClass(c),e.addClass(b),a.removeClass(c),a.addClass(b)}},selectNodes:function(a,b){for(var c=0,d=b.length;c<d;c++)g.selectNode(a,b[c],c>0)}},event:{},data:{setSonNodeLevel:function(a,b,c){if(c){var d=a.data.key.children;if(c.level=b?b.level+1:0,c[d])for(var b=0,e=c[d].length;b<e;b++)c[d][b]&&h.setSonNodeLevel(a,c,c[d][b])}}}});var d=a.fn.zTree,e=d._z.tools,f=d.consts,g=d._z.view,h=d._z.data,i=e.$;h.exSetting({edit:{enable:!1,editNameSelectAll:!1,showRemoveBtn:!0,showRenameBtn:!0,removeTitle:"remove",renameTitle:"rename",drag:{autoExpandTrigger:!1,isCopy:!0,isMove:!0,prev:!0,next:!0,inner:!0,minMoveSize:5,borderMax:10,borderMin:-5,maxShowNodeNum:5,autoOpenTime:500}},view:{addHoverDom:null,removeHoverDom:null},callback:{beforeDrag:null,beforeDragOpen:null,beforeDrop:null,beforeEditName:null,beforeRename:null,onDrag:null,onDragMove:null,onDrop:null,onRename:null}}),h.addInitBind(function(a){var b=a.treeObj,c=f.event;b.bind(c.RENAME,function(b,c,d,f){e.apply(a.callback.onRename,[b,c,d,f])}),b.bind(c.DRAG,function(b,c,d,f){e.apply(a.callback.onDrag,[c,d,f])}),b.bind(c.DRAGMOVE,function(b,c,d,f){e.apply(a.callback.onDragMove,[c,d,f])}),b.bind(c.DROP,function(b,c,d,f,g,h,i){e.apply(a.callback.onDrop,[c,d,f,g,h,i])})}),h.addInitUnBind(function(a){var a=a.treeObj,b=f.event;a.unbind(b.RENAME),a.unbind(b.DRAG),a.unbind(b.DRAGMOVE),a.unbind(b.DROP)}),h.addInitCache(function(){}),h.addInitNode(function(a,b,c){c&&(c.isHover=!1,c.editNameFlag=!1)}),h.addInitProxy(function(a){var b=a.target,d=h.getSetting(a.data.treeId),g=a.relatedTarget,i="",j=null,k="",l=null,m=null;if(e.eqs(a.type,"mouseover")?(m=e.getMDom(d,b,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(i=e.getNodeMainDom(m).id,k="hoverOverNode"):e.eqs(a.type,"mouseout")?(m=e.getMDom(d,g,[{tagName:"a",attrName:"treeNode"+f.id.A}]),m||(i="remove",k="hoverOutNode")):e.eqs(a.type,"mousedown")&&(m=e.getMDom(d,b,[{tagName:"a",attrName:"treeNode"+f.id.A}]))&&(i=e.getNodeMainDom(m).id,k="mousedownNode"),i.length>0)switch(j=h.getNodeCache(d,i),k){case"mousedownNode":l=c.onMousedownNode;break;case"hoverOverNode":l=c.onHoverOverNode;break;case"hoverOutNode":l=c.onHoverOutNode}return{stop:!1,node:j,nodeEventType:k,nodeEventCallback:l,treeEventType:"",treeEventCallback:null}}),h.addInitRoot(function(a){var a=h.getRoot(a),b=h.getRoots();a.curEditNode=null,a.curEditInput=null,a.curHoverNode=null,a.dragFlag=0,a.dragNodeShowBefore=[],a.dragMaskList=[],b.showHoverDom=!0}),h.addZTreeTools(function(a,b){b.cancelEditName=function(a){h.getRoot(this.setting).curEditNode&&g.cancelCurEditNode(this.setting,a?a:null,!0)},b.copyNode=function(a,b,c,d){if(!b)return null;if(a&&!a.isParent&&this.setting.data.keep.leaf&&c===f.move.TYPE_INNER)return null;var h=this,i=e.clone(b);return a||(a=null,c=f.move.TYPE_INNER),c==f.move.TYPE_INNER?(b=function(){g.addNodes(h.setting,a,-1,[i],d)},e.canAsync(this.setting,a)?g.asyncNode(this.setting,a,d,b):b()):(g.addNodes(this.setting,a.parentNode,-1,[i],d),g.moveNode(this.setting,a,i,c,!1,d)),i},b.editName=function(a){a&&a.tId&&a===h.getNodeCache(this.setting,a.tId)&&(a.parentTId&&g.expandCollapseParentNode(this.setting,a.getParentNode(),!0),g.editNode(this.setting,a))},b.moveNode=function(a,b,c,d){function h(){g.moveNode(j.setting,a,b,c,!1,d)}if(!b)return b;if(a&&!a.isParent&&this.setting.data.keep.leaf&&c===f.move.TYPE_INNER)return null;if(a&&(b.parentTId==a.tId&&c==f.move.TYPE_INNER||i(b,this.setting).find("#"+a.tId).length>0))return null;a||(a=null);var j=this;return e.canAsync(this.setting,a)&&c===f.move.TYPE_INNER?g.asyncNode(this.setting,a,d,h):h(),b},b.setEditable=function(a){return this.setting.edit.enable=a,this.refresh()}});var j=g.cancelPreSelectedNode;g.cancelPreSelectedNode=function(a,b){for(var c=h.getRoot(a).curSelectedList,d=0,e=c.length;d<e&&(b&&b!==c[d]||(g.removeTreeDom(a,c[d]),!b));d++);j&&j.apply(g,arguments)};var k=g.createNodes;g.createNodes=function(a,b,c,d,e){k&&k.apply(g,arguments),c&&g.repairParentChkClassWithSelf&&g.repairParentChkClassWithSelf(a,d)};var l=g.makeNodeUrl;g.makeNodeUrl=function(a,b){return a.edit.enable?null:l.apply(g,arguments)};var m=g.removeNode;g.removeNode=function(a,b){var c=h.getRoot(a);c.curEditNode===b&&(c.curEditNode=null),m&&m.apply(g,arguments)};var n=g.selectNode;g.selectNode=function(a,b,c){var d=h.getRoot(a);return(!h.isSelectedNode(a,b)||d.curEditNode!=b||!b.editNameFlag)&&(n&&n.apply(g,arguments),g.addHoverDom(a,b),!0)};var o=e.uCanDo;e.uCanDo=function(a,b){var c=h.getRoot(a);return!(!b||!(e.eqs(b.type,"mouseover")||e.eqs(b.type,"mouseout")||e.eqs(b.type,"mousedown")||e.eqs(b.type,"mouseup")))||(c.curEditNode&&(g.editNodeBlur=!1,c.curEditInput.focus()),!c.curEditNode&&(!o||o.apply(g,arguments)))}}(jQuery);