!function(a,b){define("cabin/common/widgets/dmFromValidate",function(require,a,b){if("undefined"==typeof jQuery)throw new Error("dmFromValidate’s JavaScript require jQuery");+function(a){function b(b){var c=arguments;return this.each(function(){var e=a(this),f=a.extend({},"object"==typeof b&&b),g=e.data("dm.validate");return g||e.data("dm.validate",g=new d(this,f)),"string"==typeof b&&"cleanMsg"==b?void g[b]("all"):void("string"==typeof b&&g[b](c[1]))})}var c=function(){var b={isNonEmpty:function(a,b){if(!a.length)return b},minLength:function(a,b,c){if(a.length<b)return c},maxLength:function(a,b,c){if(a.length<b)return c},isMobile:function(a,b){if(!/(^1[3|5|8][0-9]{9}$)/.test(a))return b},isEmail:function(a,b){if(!/(^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$)/.test(a))return b},between:function(a,b,c){var d=parseInt(b.split("-")[0]),e=parseInt(b.split("-")[1]);if(a.length<d||a.length>e)return c},onlyEn:function(a,b){!/^[A-Za-z]+$/.test(a)},onlyZh:function(a,b){if(!/^[\u4e00-\u9fa5]+$/.test(a))return b},onlyNum:function(a,b){if(!/^[0-9]+([.][0-9]+){0,1}$/.test(1*a))return b},isDecimal:function(a,b,d){var e=/^[0-9]\d*\.\d{2}$|^[0-9]\d*\.\d{1}$|^[0-9]\d*$/;switch(c.check("onlyInt",a,!0)&&(a=2),a+""){case"1":e=/^[0-9]\d*\.\d{1}$|^[0-9]\d*$/;break;case"2":e=/^[0-9]\d*\.\d{2}$|^[0-9]\d*\.\d{1}$|^[0-9]\d*$/;break;case"3":e=/^[0-9]\d*\.\d{3}$|^[0-9]\d*\.\d{2}$|^[0-9]\d*\.\d{1}$|^[0-9]\d*$/;break;case"4":e=/^[0-9]\d*\.\d{4}$|^[0-9]\d*\.\d{3}$|^[0-9]\d*\.\d{2}$|^[0-9]\d*\.\d{1}$|^[0-9]\d*$/}if(!e.test(1*b))return d},onlyInt:function(a,b){if(!/^[0-9]*$/.test(1*a))return b},greaterThan:function(a,b,c){if(!(a>b))return c},greaterThanEqual:function(a,b,c){if(!(a>=b))return c},isChecked:function(b,c,d){var e=a(d).find("input:checked");if(!e.length)return c},notInfo:function(){return!1}};return{check:function(){var a=arguments[0],c=[].slice.call(arguments,1);return b[a]?b[a].apply(this,c):"没有该类型的检测方式"},addStrategy:function(a,c){b[a]=c}}}(),d=function(b,c){this.type=c.type||"",this.options=c.data||[],this.element=b,a(this.element).find("[data-valid]").css("border-color","#ccc").end().find('div[promo-error-box="box"]').remove(),this.bind()};d.prototype.bind=function(){a(this.element).on("change.dm.validate","[data-valid]",a.proxy(this.validateRules,this)).on("input.dm.validate","[data-valid]",a.proxy(this.validateRules,this)).on("propertychange.dm.validate","[data-valid]",a.proxy(this.validateRules,this))},d.prototype.showMsg=function(){var b=a(this.$element),c="";b.is(".promo-chosen-input")&&(b=b.parent().parent(),c="top:100%"),this.cleanMsg(),b.css("border-color","#FF0000");var d="position: absolute; color: #EB5349; font-size: 12px; "+c,e="color: #FF0000; font-size: 14px;  display: inline; vertical-align: text-top;",f="display: inline; vertical-align: text-top; margin-left: 1px; white-space: nowrap;margin-bottom:0px";if("pop"==this.type){var g=a(this.$element).width()+50;d="display: none; position: absolute; top: 7px; left: "+g+"px; z-index:1;min-width: 100px; height: 38px; line-height: 27px; padding: 0; border: 1px solid rgb(255, 0, 0); border-radius: 4px; color: rgb(34, 34, 34); font-size: 12px; background: rgb(255, 229, 229);",e='color: #EB5349; font-size: 16px; padding-right: 10px; display: inline-block; vertical-align: text-top; position: absolute; top: 11px; left: 4px; width: 16px; height: 16px; background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAAXNSR0IArs4c6QAAAOJJREFUKBWdUrsNg0AMNVEKGnaJxAYMkIxBiRghG0DHHKxAjZIR2CENVZz3dBznQwIlsfQkn/2eP2ARYyqSAXfgAbwW0GcsM9TgIlEAE6A7YK4ICngMAO8dgS1EjhPD4XhHnayQPrkZu3H+kBwG1aZRTRIH+oxZDjRnTHqL5h5HkaoSSVMXLkuRto0oeFzZkV8vVGSnrtPV6DNmOdCctqW+fqMS/1OoyJ1o7OQ7M2Y50HDHHrisnfLc7VTXLjTPIozF1nPH/34HC0H8+wH4CRbxtNnF7sZcfHJG7I/8CdLhkX8A5DEP/D++tpoAAAAASUVORK5CYII=") center no-repeat;',f="display: inline-block; vertical-align: text-top; margin-left: 15px; white-space: nowrap; margin: 0 0 0 22px;"}b.parent().css("position","relative");var h=document.createElement("div");h.setAttribute("promo-error-box","box"),h.setAttribute("style",d),b.parent()[0].appendChild(h);var i=document.createElement("span");i.setAttribute("style",e),"pop"!=this.type&&(i.innerText="*"),h.appendChild(i);var j=document.createElement("p");j.setAttribute("style",f),j.innerText=this.errorMsg,h.appendChild(j),"pop"==this.type&&a(this.$element).on("mouseover.dm.validate",function(){a(this).siblings('div[promo-error-box="box"]').show()}).on("mouseout.dm.validate",function(){a(this).siblings('div[promo-error-box="box"]').hide()})},d.prototype.cleanMsg=function(b){return"all"==b?void a(this.element).find("[data-valid]").each(function(){a(this).css("border-color","#ccc").parent().find('div[promo-error-box="box"]').remove()}):void a.each(this.$elementList,function(){a(this).is(".promo-chosen-input")?a(this).parent().parent().css("border-color","#ccc").parent().find('div[promo-error-box="box"]').remove():a(this).css("border-color","#ccc").parent().find('div[promo-error-box="box"]').remove()})},d.prototype.validateRules=function(b){var d=this,e=!0,f=a(b.target||b.srcElement||b);d.$element=f[0],this.$elementList=[];var g=f.data("valid"),h=!1;return a.each(d.options,function(b,i){if(i.validType==g){h=!0;for(var j,k,l,m=i.valid,n=m.split("||"),o=i.errorMsg,p=o.split("||"),b=0;b<n.length;b++){if(j=n[b].split(":"),k=j.shift(),"greaterThan"===k||"greaterThanEqual"===k)for(var q=j.shift(),r=q.split("/"),s=2;s>0;){var t=a(d.element).find("[data-valid="+r[s-1]+"]");d.$elementList.push(t),j.unshift(t.val()),s--}else if("isDecimal"==k){var q=j.shift();d.$elementList.push(f[0]),j.unshift(a.trim(f[0].value)),j.unshift(q)}else d.$elementList.push(f[0]),j.unshift(a.trim(f[0].value));if(j.unshift(k),j.push(p[b]),j.push(f[0]),l=c.check.apply(f,j)){d.errorMsg=l,d.showMsg(),e=!1;break}l||d.cleanMsg()}}}),h||(d.$elementList.push(f[0]),d.cleanMsg()),e},d.prototype.submitValid=function(){var b=this,c=!0;a(b.element).find('[data-valid]:not([type="hidden"])').each(function(){a(this).parent().find('div[promo-error-box="box"]').length?c=!1:b.validateRules(this)||(c=!1)});var d=a.Event("valid.dm.validate",{isValid:c});return a(this.element).trigger(d),c},d.prototype.validInfoText=function(){var b=this,c=arguments[0]||[];a.each(c,function(c,d){b.errorMsg=d.errorMsg,b.$element=a(b.element).find("[data-valid="+d.validType+"]")[0],b.$element&&(b.$elementList=[],b.$elementList.push(b.$element),b.showMsg())})},d.prototype.changeValue=function(b){var c=this;setTimeout(function(){var d="[data-valid]";b&&(d="[data-valid = "+b+"]"),a(c.element).find(d).each(function(){c.validateRules(this)})},10)},a.fn.validator=b,a.validatorStrategy=c}(jQuery)})}(jQuery,window);