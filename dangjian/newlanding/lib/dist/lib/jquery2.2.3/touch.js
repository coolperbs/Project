!function(a){"function"==typeof define&&define.amd?define(["jquery","../vmouse","../support/touch"],a):a(jQuery)}(function(a){function b(b,c,d,e){var f=d.type;d.type=c,e?a.event.trigger(d,void 0,b):a.event.dispatch.call(b,d),d.type=f}var c=a(document),d=a.mobile.support.touch,e=d?"touchstart":"mousedown",f=d?"touchend":"mouseup",g=d?"touchmove":"mousemove";return a.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight".split(" "),function(b,c){a.fn[c]=function(a){return a?this.bind(c,a):this.trigger(c)},a.attrFn&&(a.attrFn[c]=!0)}),a.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var d=this,e=a(d),f=!1;e.bind("vmousedown",function(g){function h(){j&&(e.bind("vclick",k),clearTimeout(j))}function i(){h(),e.unbind("vclick",k).unbind("vmouseup",h),c.unbind("vmousecancel",i)}if(f=!1,g.which&&1!==g.which)return!0;var j,k,l=g.target;k=function(a){i(),f||l!==a.target?f&&a.preventDefault():b(d,"tap",a)},e.bind("vmouseup",h),c.bind("vmousecancel",i),j=setTimeout(function(){a.event.special.tap.emitTapOnTaphold||(f=!0),j=0,b(d,"taphold",a.Event("taphold",{target:l}))},a.event.special.tap.tapholdThreshold)})},teardown:function(){a(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),c.unbind("vmousecancel")}},a.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:window.devicePixelRatio>=2?15:30,verticalDistanceThreshold:window.devicePixelRatio>=2?15:30,getLocation:function(a){var b=window.pageXOffset,c=window.pageYOffset,d=a.clientX,e=a.clientY;return 0===a.pageY&&Math.floor(e)>Math.floor(a.pageY)||0===a.pageX&&Math.floor(d)>Math.floor(a.pageX)?(d-=b,e-=c):(e<a.pageY-c||d<a.pageX-b)&&(d=a.pageX-b,e=a.pageY-c),{x:d,y:e}},start:function(b){var c=b.originalEvent.touches?b.originalEvent.touches[0]:b,d=a.event.special.swipe.getLocation(c);return{time:(new Date).getTime(),coords:[d.x,d.y],origin:a(b.target)}},stop:function(b){var c=b.originalEvent.touches?b.originalEvent.touches[0]:b,d=a.event.special.swipe.getLocation(c);return{time:(new Date).getTime(),coords:[d.x,d.y]}},handleSwipe:function(c,d,e,f){if(d.time-c.time<a.event.special.swipe.durationThreshold&&Math.abs(c.coords[0]-d.coords[0])>a.event.special.swipe.horizontalDistanceThreshold&&Math.abs(c.coords[1]-d.coords[1])<a.event.special.swipe.verticalDistanceThreshold){var g=c.coords[0]>d.coords[0]?"swipeleft":"swiperight";return b(e,"swipe",a.Event("swipe",{target:f,swipestart:c,swipestop:d}),!0),b(e,g,a.Event(g,{target:f,swipestart:c,swipestop:d}),!0),!0}return!1},eventInProgress:!1,setup:function(){var b,d=this,h=a(d),i={};b=a.data(this,"mobile-events"),b||(b={length:0},a.data(this,"mobile-events",b)),b.length++,b.swipe=i,i.start=function(b){if(!a.event.special.swipe.eventInProgress){a.event.special.swipe.eventInProgress=!0;var e,h=a.event.special.swipe.start(b),j=b.target,k=!1;i.move=function(b){h&&!b.isDefaultPrevented()&&(e=a.event.special.swipe.stop(b),k||(k=a.event.special.swipe.handleSwipe(h,e,d,j),k&&(a.event.special.swipe.eventInProgress=!1)),Math.abs(h.coords[0]-e.coords[0])>a.event.special.swipe.scrollSupressionThreshold&&b.preventDefault())},i.stop=function(){k=!0,a.event.special.swipe.eventInProgress=!1,c.off(g,i.move),i.move=null},c.on(g,i.move).one(f,i.stop)}},h.on(e,i.start)},teardown:function(){var b,d;b=a.data(this,"mobile-events"),b&&(d=b.swipe,delete b.swipe,b.length--,0===b.length&&a.removeData(this,"mobile-events")),d&&(d.start&&a(this).off(e,d.start),d.move&&c.off(g,d.move),d.stop&&c.off(f,d.stop))}},a.each({taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(b,c){a.event.special[b]={setup:function(){a(this).bind(c,a.noop)},teardown:function(){a(this).unbind(c)}}}),a.event.special});